const t={board:[],textureCanvas:null,textureCtx:null,usingTexture:!1,initializeBoard(t,e){this.board=[];for(let i=0;i<e;i++){let e=[];for(let i=0;i<t;i++)e.push(0);this.board.push(e)}},getTile(t,e){return t>=0&&t<this.board[0].length&&e>=0&&e<this.board.length?this.board[e][t]:null},setTile(t,e,i){t>=0&&t<this.board[0].length&&e>=0&&e<this.board.length&&(this.board[e][t]=i)},getPixel(t,e){if(!this.textureCtx||t<0||t>=this.textureCanvas.width||e<0||e>=this.textureCanvas.height)return"#000000";let i=this.textureCtx.getImageData(t,e,1,1).data;return`rgb(${i[0]}, ${i[1]}, ${i[2]})`},setTexture(t){this.textureCanvas=document.createElement("canvas"),this.textureCanvas.width=t.width,this.textureCanvas.height=t.height,this.textureCtx=this.textureCanvas.getContext("2d"),this.textureCtx.drawImage(t,0,0),this.usingTexture=!0,this.initializeBoard(t.width,t.height)},clearTexture(){this.usingTexture=!1,this.textureCanvas=null,this.textureCtx=null},getWidth(){return this.board[0].length},getHeight(){return this.board.length},increaseElevation(t,e,i){if(t>=0&&t<this.getWidth()&&e>=0&&e<this.getHeight()){if(i&&this.usingTexture){let i=this.getPixel(t,e);for(let t=0;t<this.getHeight();t++)for(let e=0;e<this.getWidth();e++)this.getPixel(e,t)===i&&this.setTile(e,t,Math.max(0,this.getTile(e,t)+1))}else this.setTile(t,e,Math.max(0,this.getTile(t,e)+1))}},decreaseElevation(t,e,i){if(t>=0&&t<this.getWidth()&&e>=0&&e<this.getHeight()){if(i&&this.usingTexture){let i=this.getPixel(t,e);for(let t=0;t<this.getHeight();t++)for(let e=0;e<this.getWidth();e++)this.getPixel(e,t)===i&&this.setTile(e,t,Math.max(0,this.getTile(e,t)-1))}else this.setTile(t,e,Math.max(0,this.getTile(t,e)-1))}},rotateWorld(t=!1){let e;if(this.usingTexture&&this.textureCanvas){let e=document.createElement("canvas");e.width=this.textureCanvas.height,e.height=this.textureCanvas.width;let i=e.getContext("2d");i.clearRect(0,0,e.width,e.height),t?(i.rotate(-Math.PI/2),i.drawImage(this.textureCanvas,-this.textureCanvas.width,0)):(i.rotate(Math.PI/2),i.drawImage(this.textureCanvas,0,-this.textureCanvas.height)),this.textureCanvas=e,this.textureCtx=i}e=t?this.board[0].map((t,e)=>this.board.map(t=>t[t.length-1-e])):this.board[0].map((t,e)=>this.board.map(t=>t[e]).reverse()),this.board=e}};t.initializeBoard(16,16);const e=document.getElementById("myCanvas"),i=e.getContext("2d");function a(t,e){if(t.startsWith("rgb")){let[i,a,r]=t.substring(4,t.length-1).split(",").map(Number);return i=Math.min(255,Math.max(0,Math.round(i+255*e))),a=Math.min(255,Math.max(0,Math.round(a+255*e))),r=Math.min(255,Math.max(0,Math.round(r+255*e))),`rgb(${i}, ${a}, ${r})`}let i=!1;"#"==t[0]&&(t=t.slice(1),i=!0);let a=parseInt(t,16),r=(a>>16)+255*e;r>255?r=255:r<0&&(r=0);let s=(a>>8&255)+255*e;s>255?s=255:s<0&&(s=0);let l=(255&a)+255*e;l>255?l=255:l<0&&(l=0);let n=(l|s<<8|r<<16).toString(16);for(;n.length<6;)n="0"+n;return(i?"#":"")+n}function r(i){e.width;for(let e=0;e<t.getHeight();e++)for(let r=0;r<t.getWidth();r++){let s;let l=t.getTile(r,e);s=t.usingTexture?t.getPixel(r,e):function(t){switch(t){case 0:return"#0000ff";case 1:return"#ffff00";case 2:case 3:return"#00c800";case 4:case 5:default:return"#808080";case 6:return"#ffffff"}}(l);for(let t=0;t<=l;t++)!function(t,e,i,r,s,l){var n,h,o,u,g,d,x,c,v;let{v1x:f,v1y:m,v2x:T,v2y:C,v3x:b,v3y:y,v4x:p,v4y:w,v5y:P,v6y:M,v7y:I}=function(t,e,i){let a=(t-e)*16/2,r=(t+e)*8/2,s=-(8*i);return{v1x:a,v1y:r+s,v2x:a+8,v2y:r+4+s,v3x:a,v3y:r+8+s,v4x:a-8,v4y:r+4+s,v5y:r+8,v6y:r+4,v7y:r+4}}(t,e,i),E=r;l&&(E=a(r,.2)),s.fillStyle=E,n=s,h=f,o=m,u=T,g=C,d=b,x=y,c=p,v=w,n.beginPath(),n.moveTo(h,o),n.lineTo(u,g),n.lineTo(d,x),n.lineTo(c,v),n.closePath(),s.fill(),i>0&&(s.fillStyle=a(E,-.2),s.beginPath(),s.moveTo(p,w),s.lineTo(b,y),s.lineTo(f,P),s.lineTo(p,M),s.closePath(),s.fill(),s.fillStyle=a(E,-.4),s.beginPath(),s.moveTo(T,C),s.lineTo(b,y),s.lineTo(f,P),s.lineTo(T,I),s.closePath(),s.fill())}(r,e,t,s,i,!1)}}function s(){let t=e.width/2;i.clearRect(-t,-100,e.width,e.height),r(i)}if(i)i.translate(e.width/2,250),r(i);else{console.error("Canvas not supported!");let t=document.getElementById("myCanvas");t.parentNode.replaceChild(document.createTextNode("Your browser does not support the canvas element."),t)}({registerListeners:()=>{console.log("registering listeners");let e=document.getElementById("uploadButton"),i=document.getElementById("textureUpload"),a=document.getElementById("resetButton");e.addEventListener("click",()=>{i.click()}),i.addEventListener("change",function(e){console.log("upload clicked");let i=e.target,a=i.files?i.files[0]:null;if(a&&"image/png"===a.type){let e=new FileReader;e.onload=function(e){if(e.target&&e.target.result){let i=new Image;i.onload=function(){t.setTexture(i),s()},i.src=e.target.result}},e.readAsDataURL(a)}else alert("Please upload a PNG image.")}),a.addEventListener("click",()=>{t.clearTexture(),t.initializeBoard(16,16),s(),i.value=""})}}).registerListeners();
//# sourceMappingURL=index.4b4613f2.js.map
